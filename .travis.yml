language: python
python:
  - 3.7
cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/.ccache  # https://github.com/travis-ci/travis-ci/issues/5853

env:
  global:
    - secure: "gAAAAABgHBVSi0Mc1ORMX2_7Y14SOfblvc5ByRoAoSIpvI8Q1fSDtqPwKDtP3K6fsWJFPtV0UidI01MlA8XJtPWol_UkLmAjstczAspjbTJPtKb4ToMCtVJd3snLv9LBM9kHX6mq1X1x6xMYosgW9zte_XwfGiqTXrA1nmJYGkM2hITaD15PIE96tzZPgizjl0_W-Uzd400lVGE8sf2B1ey2KTnFtqg9LtDQ8rlhdTE4uoQrLlVR4uoU2UD8QX7wVdW__gEYyyOhNlLI4TsBAW25O8w7r-vUxHilFmTF6HmC3C1bCgPCpk0yKzFjkc-v6bArwGRPt4QEIWk0wTZogt8CezRl_9W6kaJ-t7LiIQc3xv029Df8a1o3orP5OW1MR0ypjokuzQJvJFmsyUhbwhP1G2BmZ0GNtrh-D3qXGDBMGME4-pobVYXrhNPkmfp2k-sutXN7A0DuqGQ_LX-QzIFd-JKb4jXPTI5v9KTITMXBhvUYBwM27T_IsYHKELGwF1J8WRjYgvHzOi-RnCK8POjIcYD33HWTxCZqyRfMm80x5rjPJpS4QSWAJovSKOfmPK3ZBFhXqwycFjkWem0u1vwOk881JG5Oed7xp7iLssg9AWsK_1f5RDveMSfY2uOBaOwnrhy4e0e42ieS-_T2fseY_nd-4LTrYpMM9sg7RuZWBmQKLpiZqCGNXJ1_9gw7UV292XS2WkDe_Scr3Pb0OWuyaKVExWpuWCAOX3gyNzDgssw5_Pui9hR21MjGhQ2ta70KV8xmH0jJ_i7A2xVgk0J4nkTSF74AcNvnqUxgzkkS3lsmCm0aOj01bcojnwhFOuDa2Hya5bDwfDkMAUDzOOhM0nybA1fp2RXQD-XCoPbulVE68UYni1Wr5iy9hCXCii0_mGJfOuq2KwFikRKkF_t9D55pXBe2Q7OhrRPF31v3cQSxyfyVQq_axoO9aJE1Ij-l4VlLUS3DeZbpEysQYgzv3ld71kxmcWW36QLveiHXjEBBVjCFrqGCfgbGeXPKTy_D8ePdZ0L18NVHAeh33U_VIcmAw3qTMNcnuFDY20Vla4GOsijcCDy6x9BrinJn8HWx-Lu9X3BzH7Q2ujdknABTgumrF77gvk1cU_KUbw1F-Pk_lg3haTonrdlgFkY5vEE6QTorswhkAmmAdSYV4B38yau7965s0cis8jnc0XvMRsnOTwJXEFv45KruKHZ-6LuwB9jdTmM0X4ytkwTeNfgXXGvlB1ZAO9n_eKyiziQxBJDf4Vdk-dn9Tno8lsFqxfNuEv1zo5hK8ioJraSeD3-0uAAQzXmYXrdnyYY_cYc4_fLlMKpiN5xRE9-yoVck29MiJSKewV0oIiFstWzAs07HbfevzujlwlkPtOvWZFrFMF-2R4IlpslNeGnFPXl09aP9q2zWZGqRXz1jRgZhfyiKU0EmB_kl68sWL_uHsQnvWjBjJjWe30zo3PB6ywbIvYHj8SqG9ksbsDgAKI1V935n-9p7dpAM5DTy33rtDt9wULmpd_4f2ewTJ8uXWAkN8a1BlC3YnaW0xK3-cmKD7SdF-RA9F36btAXIDfZvGLXaTB0TGXom957B4ZGUFNicdnWc7xBgfoRm4kIhBp-NwxhiaorupQhMiAC5TW90YTZjFrf1rSHrs2G2CxQ2gEpjRNHsvThXNMUPSuiwNTSUtvX5KRv-85axiHi14HIqKTqjoxN-K3UBuJjFWpASXKazZHWnGBeFq1Q3d--1mzlxkaosnw_dKghfhexg-LbGpZNjVZvtkZk6quA6xapUljGiQRrx_KduUjTUtVGiVLf_JEUUDAo3KLsyxdp4ZQL4jLEdzTieGLSNxtfM2NUGiRxmsL9KlU1IfoAV0m70oKjO8cu9XeMvx4tH35T87bTfeCwRY5eMsTY3b725WVTL8bPJ4yS8qpSMMH7Da2t6lemX9lGgnmPyCaF41ZwJpSkozv2dCuvGHneOt_FCUwH6UNam4jRSbJMzXUZ50f61d_OhXQpLB09AtCcv8fOuh0ZWf8tF8mmDsukS87NMzdD9cPa56U0wZ2ETxNxlUmM7x0-jkgVWo01ZepiZ0RRjWkhPQVy6Nk5UtmZZlFRmQVlPwGPWMHrTUexfE16uu79-FzoSevLItuvTD-YHHxDoAkM51W3t0GIiMDfd1uoxJL_exbSMYKtL1dIZc8A5D4y24fP1ZPRl3mUIiReTAw3M8XQ1u9v4MUUciR1fSLgz8M44kHYK6JIswp2Ax6Cmk5GmXhkI6gYYxCFnOKGCTeepybc717gkpweB52CSpDUR0VEJpsT79qPAjvudWJsKd7I0g5czduesvTE17KggSmZFMMZwMfDrFNDlgJEyt3Kp1QVsW3mA6zhlKETZOhfP5fxcWMRoSUsdtzY85nNK4o2fYlynzWGuOBfaIz0aHzad6wih7SrO4d7TjWPm3IIXrFkLgeYO0Sr-gxTrTcSiFtiBYZ2Vp79VzFbZRkUs07Iv05OmIqPLym-S_aWXWlG3jvEg-Bd1K7erwUDgCaTwArPd8yndIT6NveLOoaYy1NwlXZRFvuGFh5h3wtRzOmp2ZaubGvLwCJKw9UU6M5I_a_eI_KLLrqx5sTJP3EJxxxN4PelyXNRdmRDtBHCPeotl07n02PhkuMUtUCOvwQ5oF3pAIFZrOj7Ur_uJh-TP90wIouqszQ9KuyoIb76mDdL0M74TdqfZ2pgc3OTfd9Uf1Un_Vf3l9a8FiA9GjXt60tOkSYGMBrdr_b2-5cWeN3kkSCFQP3ECI4IdoK6MpPF5nsGjnDubrhQAUwnpOuo9CJJbValOUdCu8Sta7UNBOeaSbsMRgf7jzoiCWEoga5FVL52S3NTpBWIiY82PLlVSPttI-9vaXZMmaLXYf7ajbwo6dYpSRHitnbFz1UpsOJt6zC0lcAwjLgEWODs1mzS0TAAx7IKFxH69lMXRGHKDydEzEoC1_r9ZpFrUvqLZ_vGR9qdz2_1wXzV3uLhGKry0PX4JbM2iPKb1K7jsFfESBMXvAkpJVGX8c2nHUjeDWxnOsUciRyujiQpo6GvXJMzpRDOkh3L2PVNwhmrvLmIfA4eNbTszEu7u10udx6LGuuFQrCCIrE0ykczqprhgmNDZns28XifeT-ME_6Aqd_JYGl-1CARcNld1jYxvIiE6VYjLnylj0Cw5jjlLVTEcRJMKS8i-OoR-dwGabU7VHsxxB5MruLIwSiiXguFs3WgSIu-UeTeonIVQ5diLqDRwWvHZ5Ur900qTUaNSxz0CvywkBGh5nvhBwOVL4p9_pgSHSxckPUR0scH9OHuBwkupTFwQOYTmOTYgSfr2oPkr-jFYSx3A7VWtJQM3zFX5j80aldlPerC_VKfS-879QgOR4eA-39cgFgl8fF831ROlspHurCQEJ_jrUGmnqUozQcf5BkrqUk5wnTZHWXjwR0aJwz2_c8eC-xtdqYV5kJiFDAJg3OKgqBmW_J2WgeFwZyHx1LW1QAG9DiElP7OHxZ9ak1FBGQXPMykJvrET8YZxftH76Ra6LNbVFHtWNo26yvS4ZCu8p6iSwMUnSknmxS63OY2L4f25B0fa4t5S6pxVD8C80Lj6dqcQli99bcHacRzlfxc1DgnNnmGEMfGz4D5KRRnOkauEeAyDMmRaTx41EUbj2r5n2pFad0wY6bkIuMDuDxVOq7Db8HmqwryJXfN-9NC3csH-8YUeTZRiB9FsGWJxLyRPDS5dhVjUiarKLM2-T6dtLRIS-LPLfLjEcwsubKeO7sH7lnYqyP7gBV_GRmQHiZPNODrTSBEA1MpOLdsxFOfMwUNKvtt4QBEr8kenUzX-gEcXeWyUXgegK5MZTMBfe7zB51cj7e3nSW-9Lmd31C4w4sgZmRoFdxwBEAsymTptkKAwr7vVRpjj-crkHQEwN9It-lS5MehQsHjKh8RPYihs8mhln_CKAK8O40jZGKBuGfCVV4Us1qRs-_2xrzT9dq-ZNkMOZIHh7JOyjQCr0ur9HX2QF2LpKsozRFyq5LjEusr_etRNQGHNmqns5uF7qXsAA66cw6it1iktefv7tJMjaYkUgcWRqPSBYspd43v2UpzAKDA7Rm7FmOlGtKhCc_bDKzu0eYYGiwFrQUVlYQB1B2MA3P7LV1T_SVzZrQCM72nIWnZPa-qeTLQ6qa8FJ-AxBvUdtEcSEhmSyuMPjAoEo-0S7Ux3yIDpM_P-roiYuIPfiJVx87UQfRy4guJWIlEFkPLzA3WI7uab-GQw9B6welqHGAaT53uDVAdkW74smuuJHDcPXU1y0mwGPiZCfYlyZ-qlShckiLrR3TpMJICYvjAshGFIv0euJZDbGskUdnHxdqiHLbZUMhBnbbl6xZKggNftOGG8EJSpj-WtrjHUJCW3ObNck-aTX3iOYwyXc_CYGFwt5iplmf92H7i5jS-HveAKam47bKXjmelNxJV-3Q=="
    - CODECOV_TOKEN: "20743922-ec8f-4eb5-85d1-e822b7b088be"

install:
  # The versions of pip and numpy that come pre-installed are often too old and
  # can cause problems. Upgrade them.
  - pip install --upgrade pip numpy
  # Install this package and the packages listed in requirements.txt.
  - pip install .
  # Install extra requirements for running tests and building docs.
  - pip install -r requirements-dev.txt

script:
  - coverage run -m pytest  # Run the tests and check for test coverage.
  - coverage report -m  # Generate test coverage report.
  - codecov  # Upload the report to codecov.
  - set -e # If any of the following steps fail, just stop at that point
  - make -C docs html  # Build the documentation.
  #- pip install doctr
  #- doctr deploy --built-docs docs/build/html . # Publish the documentation

deploy:
  # Use github pages to deploy process
  provider: pages
  # Keep pages that were built
  skip-cleanup: true
  # Directory where the html files are generated
  local_dir: docs/build/html
  # Github security/auth token
  github-token: $GITHUB_TOKEN
  # Incremental commit to keep old build/files from previous deployments
  keep-history: false
  # Git branch on which it should deploy (master, gh-pages)
  target_branch: gh-pages
  on:
    # which branch on commit/push will trigger deployment
    branch: master
